# ฺฏุฒุงุฑุด ุชุญูู ุงููุช ู ูู ูพุฑูฺู (REV07)

**ุชุงุฑุฎ ฺฏุฒุงุฑุด:** {{DATE}}
**ุชูู ฺฉููุฏู:** ุฌููุฒ (Jules)
**ูุณุฎู ููุฑุฏ ุจุฑุฑุณ:** REV07

---

## ฑ. ููุฏูู ู ุฎูุงุตู ูุถุนุช
ูุณุฎู `REV07` ุจุง ุชูุฑฺฉุฒ ุจุฑ ุฑูุน ุขุณุจโูพุฐุฑโูุง ุจุญุฑุงู ฺฏุฒุงุฑุด ุดุฏู ุฏุฑ `REV06` ููุชุดุฑ ุดุฏู ุงุณุช. ุจุฑุฑุณโูุง ูุดุงู ูโุฏูุฏ ฺฉู ุชู ุชูุณุนูโุฏููุฏู ุงฺฉุซุฑ ุญูุฑูโูุง ุงููุช ุณุทุญ ุจุงูุง (Critical) ุงุฒ ุฌููู ุขูพููุฏ ูุงู ูุฎุฑุจ ู ุงุนุชุจุงุฑุณูุฌโูุง ูุงูุต ุฑุง ุจุฑุทุฑู ฺฉุฑุฏู ุงุณุช.

ุจุง ุงู ุญุงูุ ุญุฐู `Dockerfile` ุจุงุนุซ ุดุฏู ุงุณุช ฺฉู ูุฑุขูุฏ ุงุณุชูุฑุงุฑ ู ุชุณุช ูพูุง (Dynamic Analysis) ุจุง ูุดฺฉู ููุงุฌู ุดูุฏ. ููฺูู ุจุฑุฑุณโูุง ุนูู ุงุณุชุงุชฺฉ ูุดุงูโุฏููุฏู ูุฌูุฏ ุฑุณฺฉโูุง XSS ุฏุฑ ูุงู View ุงุณุช.

---

## ฒ. ุชุญูู ุชุบุฑุงุช (Diff Analysis: REV06 vs REV07)

### โ ุงุตูุงุญุงุช ุงูุฌุงู ุดุฏู (Verified Fixes)
1.  **ุฑูุน ุจุงฺฏ ุจุญุฑุงู ุขูพููุฏ ูุงู:**
    *   ุฏุฑ ูุงู `WorkPackageProgressRequest.php`ุ ุงุนุชุจุงุฑุณูุฌ `mimes:jpg,jpeg,png,webp,pdf,doc,docx` ุงุถุงูู ุดุฏู ุงุณุช. ุงู ุชุบุฑ ุฌูู ุขูพููุฏ ุดูโูุง PHP ุฑุง ุฏุฑ ุจุฎุด ูพุดุฑูุช ูุธุงู ูโฺฏุฑุฏ.
2.  **ูพุงุฏูโุณุงุฒ ุฏูุงุน ุฏุฑ ุนูู (Defense in Depth):**
    *   ูุชุฏ `FileLibraryController::upload` ุจุงุฒููุณ ุดุฏู ู ุงฺฉููู ุจู ุตูุฑุช ุฏุงุฎู ูพุณููุฏ (`extension`) ู ููุน ูุงู (`mime`) ุฑุง ฺฺฉ ูโฺฉูุฏ. ุงู ฺฉ ูุงู ุงููุช ุจุณุงุฑ ููู ุงุณุช ฺฉู ุญุช ุงฺฏุฑ ฺฉูุชุฑูุฑูุง ุฏฺฏุฑ ูุฑุงููุด ฺฉููุฏ ูุงู ุฑุง ฺฺฉ ฺฉููุฏุ ุงู ูุชุฏ ุฌูู ุฐุฎุฑู ูุงู ูุฎุฑุจ ุฑุง ูโฺฏุฑุฏ.
3.  **ุจูุจูุฏ Mass Assignment ุฏุฑ ูุฏู WorkPackage:**
    *   ููุฏูุง ุญุณุงุณ `uid`, `status` ุงุฒ ุขุฑุงู `$fillable` ุญุฐู ุดุฏูโุงูุฏ.
    *   ุฏุฑ ูุชุฏ `booted`ุ ููุงุฏุฑ ุงููู ุงูู (`pending`, `null`) ุจุฑุง `status` ู `published_at` ุชุนู ุดุฏู ุงุณุช.

### โ๏ธ ุชุบุฑุงุช ูุงุฒููุฏ ุจุฑุฑุณ (Needs Attention)
1.  **ูุฏู SupportSystem:**
    *   ููุฏูุง `uid` ู `status` ุงุฒ `$fillable` ุญุฐู ุดุฏูโุงูุฏ (ูุซุจุช).
    *   ููุฏ `created_by` ููฺูุงู ุฏุฑ `$fillable` ุงุณุช. ุงฺฏุฑฺู ูุนูููุงู ุฏุฑ ฺฉูุชุฑูุฑ ููุฏุงุฑุฏู ูโุดูุฏุ ุงูุง ุจูุชุฑ ุงุณุช ุงุฒ ูุณุช ููุฏูุง ูุงุจู ูพุฑ ุดุฏู ุชูุณุท ฺฉุงุฑุจุฑ ุญุฐู ุดูุฏ.
2.  **ุญุฐู Dockerfile:**
    *   ูุงู `Dockerfile` ุงุฒ ูพุฑูฺู ุญุฐู ุดุฏู ุงุณุช. ุงู ููุถูุน ุจุงุนุซ ุดุฏ ุงูฺฉุงู ุชุณุช ุงุฌุฑุง ูพุฑูฺู ุฏุฑ ูุญุท ุงุฒููู ุงุฒ ุจู ุจุฑูุฏ ู ุชุณุชโูุง ุนููฺฉุฑุฏ (Dynamic Analysis) ุงูุฌุงู ูุดูุฏ.

---

## ณ. ุงูุชูโูุง ุงููุช ุฌุฏุฏ (Security Findings)

### ๐ด ููุงุฑุฏ ููู (High) - ุขุณุจโูพุฐุฑ XSS ุฏุฑ Views
ุจุฑุฑุณ ฺฉุฏูุง Blade ูุดุงู ูโุฏูุฏ ฺฉู ุฏุฑ ููุงุฑุฏ ูุชุนุฏุฏ ุงุฒ ุฏุณุชูุฑ `{!! !!}` ุจุฑุง ฺุงูพ ููุงุฏุฑ ูุฑูุฏ ฺฉุงุฑุจุฑ ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุงู ฺฉุงุฑ ุจุณุงุฑ ุฎุทุฑูุงฺฉ ุงุณุช ุฒุฑุง ุงฺฏุฑ ฺฉุงุฑุจุฑ ฺฉุฏ ุฌุงูุงุงุณฺฉุฑูพุช ูุฎุฑุจ ูุงุฑุฏ ฺฉูุฏ ู ุงุนุชุจุงุฑุณูุฌ ุจู ูุฑ ุฏูู ุฑุฏ ุดูุฏ ุง ุฏุงุฏู ุงุฒ ูุจู ุขููุฏู ุจุงุดุฏุ ฺฉุฏ ุฏุฑ ูุฑูุฑฺฏุฑ ูุฑุจุงู ุงุฌุฑุง ูโุดูุฏ (Reflected/Stored XSS).

*   **ูุญู ูููุน:** `Modules/WorkPackageManager/Resources/views/edit.blade.php` (ู ุณุงุฑ ูุงูโูุง ูุดุงุจู)
*   **ฺฉุฏ ุขุณุจโูพุฐุฑ:**
    ```blade
    <textarea ...>{!! old('desc', $WorkPackage->desc) !!}</textarea>
    <textarea ...>{!! old('rules', $WorkPackage->rules) !!}</textarea>
    ```
*   **ุฑุณฺฉ:** ุงฺฏุฑ ฺฉุงุฑุจุฑ ุฏุฑ ููุฏ `desc` ุงุณฺฉุฑูพุช `<script>alert(1)</script>` ูุงุฑุฏ ฺฉูุฏ ู ูุฑู ุจู ุฏูู (ูุซู ุฎุทุง ููุฏ ุฏฺฏุฑ) ุฏูุจุงุฑู ููุงุด ุฏุงุฏู ุดูุฏุ ุงุณฺฉุฑูพุช ุงุฌุฑุง ูโุดูุฏ.
*   **ุฑุงูโุญู:** ุงุณุชูุงุฏู ุงุฒ ุณูุชฺฉุณ ุงุณุชุงูุฏุงุฑุฏ `{{ }}` ฺฉู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฎุฑูุฌ ุฑุง Escape ูโฺฉูุฏุ ุง ุงุณุชูุงุฏู ุงุฒ `e()` ูุจู ุงุฒ ฺุงูพ.

### ๐ ููุงุฑุฏ ูุชูุณุท (Medium) - ูุดฺฉูุงุช ูุญุท
*   **ุนุฏู ุงูฺฉุงู ุงุฌุฑุง ูพุฑูฺู:** ุจู ุฏูู ุญุฐู ุฏุงฺฉุฑ ู ูุจูุฏ PHP ุฏุฑ ูุญุท ุชุณุช ูุนูุ ุงุทููุงู ุงุฒ ุตุญุช ุนููฺฉุฑุฏ ฺฉุฏ (Functionality) ููฺฉู ูุณุช. ุชุบุฑุงุช ฺฉุฏ ุตุญุญ ุจู ูุธุฑ ูโุฑุณูุฏ ุงูุง ุชุณุช ูุดุฏูโุงูุฏ.

---

## ด. ูุถุนุช ุจุงฺฏโูุง ูุจู
*   ๐ด **ุขูพููุฏ ูุงู ุฏุฑ Progress:** โ ุฑูุน ุดุฏ.
*   ๐ด **ุนุฏู ุงุนุชุจุงุฑุณูุฌ ุฏุงุฎู FileLibrary:** โ ุฑูุน ุดุฏ.
*   ๐ **Mass Assignment:** โ ุชุง ุญุฏ ุฒุงุฏ ุฑูุน ุดุฏ.

---

## ต. ฺฺฉโูุณุช ุชูุณุนูโุฏููุฏู (Developer Checklist)

1.  [ ] **ููุฑ:** ุฌุงฺฏุฒู ุชูุงู ููุงุฑุฏ `{!! old(...) !!}` ุจุง `{{ old(...) }}` ุฏุฑ ูุงูโูุง Bladeุ ูฺฏุฑ ุงูฺฉู ุงุทููุงู ฑฐฐูช ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุญุชูุง HTML ุงูู ุงุณุช.
2.  [ ] **ุฒุฑุณุงุฎุช:** ุจุงุฒฺฏุฑุฏุงูุฏู `Dockerfile` ุง ุงุฑุงุฆู ูุณุชูุฏุงุช ุฌุฏุฏ ุจุฑุง ูุญูู ุงุฌุฑุง ู ุงุณุชูุฑุงุฑ ูพุฑูฺู.
3.  [ ] **ุจูุจูุฏ:** ุญุฐู `created_by` ุงุฒ `$fillable` ุฏุฑ ูุฏู `SupportSystem` ู ููุฏุงุฑุฏู ุขู ุฏุฑ ฺฉูุชุฑูุฑ (ูุดุงุจู ฺฉุงุฑ ฺฉู ุจุฑุง `uid` ุงูุฌุงู ุดุฏ).
4.  [ ] **ุจุฑุฑุณ ููุง:** ุงุทููุงู ุงุฒ ุงูฺฉู ูุฑูุฏโูุง `desc` ู `rules` ุฏุฑ `WorkPackageManager` ูุงุฒ ุจู ุชฺฏโูุง HTML ูุฏุงุฑูุฏ. ุงฺฏุฑ ูุงุฒ ุฏุงุฑูุฏุ ุจุงุฏ ุงุฒ ฺฉ ฺฉุชุงุจุฎุงูู Purifier (ูุซู HTMLPurifier) ุงุณุชูุงุฏู ุดูุฏุ ูู ฺุงูพ ูุณุชูู.

---
**ุชุงุฏ ููุง:** ูุณุฎู `REV07` ุงุฒ ูุธุฑ ุงููุช Backend ูพุดุฑูุช ุนุงู ุฏุงุดุชู ุงุณุช. ุจุง ุฑูุน ูุดฺฉูุงุช XSS ุฏุฑ Frontend ู ุจุงุฒฺฏุฑุฏุงูุฏู ูุงุจูุช ุงุณุชูุฑุงุฑุ ูพุฑูฺู ุขูุงุฏู ุงูุชุดุงุฑ ููุง ุฎูุงูุฏ ุจูุฏ.
